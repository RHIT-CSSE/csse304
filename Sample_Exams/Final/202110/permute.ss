(define permute
  (lambda (L)
    (if (null? L)
        '()
        (if (null? (cdr L)) 
            (list L)
            (let inner ([inner-L L])
              (if (null? inner-L)
                  '()
                  (append (map (lambda (x) (cons (car inner-L) x))
                               (permute (remove (car inner-L) L)))
                          (inner (cdr inner-L)))))))))

;; >(permute '(0 2 4 6 8))
;; ((0 2 4 6 8) (0 2 4 8 6) (0 2 6 4 8) (0 2 6 8 4) (0 2 8 4 6)
;;  (0 2 8 6 4) (0 4 2 6 8) (0 4 2 8 6) (0 4 6 2 8) (0 4 6 8 2)
;;  (0 4 8 2 6) (0 4 8 6 2) (0 6 2 4 8) (0 6 2 8 4) (0 6 4 2 8)
;;  (0 6 4 8 2) (0 6 8 2 4) (0 6 8 4 2) (0 8 2 4 6) (0 8 2 6 4)
;;  (0 8 4 2 6) (0 8 4 6 2) (0 8 6 2 4) (0 8 6 4 2) (2 0 4 6 8)
;;  (2 0 4 8 6) (2 0 6 4 8) (2 0 6 8 4) (2 0 8 4 6) (2 0 8 6 4)
;;  (2 4 0 6 8) (2 4 0 8 6) (2 4 6 0 8) (2 4 6 8 0) (2 4 8 0 6)
;;  (2 4 8 6 0) (2 6 0 4 8) (2 6 0 8 4) (2 6 4 0 8) (2 6 4 8 0)
;;  (2 6 8 0 4) (2 6 8 4 0) (2 8 0 4 6) (2 8 0 6 4) (2 8 4 0 6)
;;  (2 8 4 6 0) (2 8 6 0 4) (2 8 6 4 0) (4 0 2 6 8) (4 0 2 8 6)
;;  (4 0 6 2 8) (4 0 6 8 2) (4 0 8 2 6) (4 0 8 6 2) (4 2 0 6 8)
;;  (4 2 0 8 6) (4 2 6 0 8) (4 2 6 8 0) (4 2 8 0 6) (4 2 8 6 0)
;;  (4 6 0 2 8) (4 6 0 8 2) (4 6 2 0 8) (4 6 2 8 0) (4 6 8 0 2)
;;  (4 6 8 2 0) (4 8 0 2 6) (4 8 0 6 2) (4 8 2 0 6) (4 8 2 6 0)
;;  (4 8 6 0 2) (4 8 6 2 0) (6 0 2 4 8) (6 0 2 8 4) (6 0 4 2 8)
;;  (6 0 4 8 2) (6 0 8 2 4) (6 0 8 4 2) (6 2 0 4 8) (6 2 0 8 4)
;;  (6 2 4 0 8) (6 2 4 8 0) (6 2 8 0 4) (6 2 8 4 0) (6 4 0 2 8)
;;  (6 4 0 8 2) (6 4 2 0 8) (6 4 2 8 0) (6 4 8 0 2) (6 4 8 2 0)
;;  (6 8 0 2 4) (6 8 0 4 2) (6 8 2 0 4) (6 8 2 4 0) (6 8 4 0 2)
;;  (6 8 4 2 0) (8 0 2 4 6) (8 0 2 6 4) (8 0 4 2 6) (8 0 4 6 2)
;;  (8 0 6 2 4) (8 0 6 4 2) (8 2 0 4 6) (8 2 0 6 4) (8 2 4 0 6)
;;  (8 2 4 6 0) (8 2 6 0 4) (8 2 6 4 0) (8 4 0 2 6) (8 4 0 6 2)
;;  (8 4 2 0 6) (8 4 2 6 0) (8 4 6 0 2) (8 4 6 2 0) (8 6 0 2 4)
;;  (8 6 0 4 2) (8 6 2 0 4) (8 6 2 4 0) (8 6 4 0 2) (8 6 4 2 0))
;; > (permute '())
;; ()
;; > (permute '(1))
;; ((1))
;; > (permute '(2 4 6))
;; ((2 4 6) (2 6 4) (4 2 6) (4 6 2) (6 2 4) (6 4 2))
;; > (permute '(3 5 7 9))
;; ((3 5 7 9) (3 5 9 7) (3 7 5 9) (3 7 9 5) (3 9 5 7) (3 9 7 5) (5 3 7 9) (5 3 9 7) (5 7 3 9) 
;;  (5 7 9 3) (5 9 3 7) (5 9 7 3) (7 3 5 9) (7 3 9 5) (7 5 3 9) (7 5 9 3) (7 9 3 5) (7 9 5 3) 
;;  (9 3 5 7) (9 3 7 5) (9 5 3 7) (9 5 7 3) (9 7 3 5) (9 7 5 3))
;; > (permute '(0 2 4 6 8))
;; ((0 2 4 6 8) (0 2 4 8 6) (0 2 6 4 8) (0 2 6 8 4) (0 2 8 4 6)
;;  (0 2 8 6 4) (0 4 2 6 8) (0 4 2 8 6) (0 4 6 2 8) (0 4 6 8 2)
;;  (0 4 8 2 6) (0 4 8 6 2) (0 6 2 4 8) (0 6 2 8 4) (0 6 4 2 8)
;;  (0 6 4 8 2) (0 6 8 2 4) (0 6 8 4 2) (0 8 2 4 6) (0 8 2 6 4)
;;  (0 8 4 2 6) (0 8 4 6 2) (0 8 6 2 4) (0 8 6 4 2) (2 0 4 6 8)
;;  (2 0 4 8 6) (2 0 6 4 8) (2 0 6 8 4) (2 0 8 4 6) (2 0 8 6 4)
;;  (2 4 0 6 8) (2 4 0 8 6) (2 4 6 0 8) (2 4 6 8 0) (2 4 8 0 6)
;;  (2 4 8 6 0) (2 6 0 4 8) (2 6 0 8 4) (2 6 4 0 8) (2 6 4 8 0)
;;  (2 6 8 0 4) (2 6 8 4 0) (2 8 0 4 6) (2 8 0 6 4) (2 8 4 0 6)
;;  (2 8 4 6 0) (2 8 6 0 4) (2 8 6 4 0) (4 0 2 6 8) (4 0 2 8 6)
;;  (4 0 6 2 8) (4 0 6 8 2) (4 0 8 2 6) (4 0 8 6 2) (4 2 0 6 8)
;;  (4 2 0 8 6) (4 2 6 0 8) (4 2 6 8 0) (4 2 8 0 6) (4 2 8 6 0)
;;  (4 6 0 2 8) (4 6 0 8 2) (4 6 2 0 8) (4 6 2 8 0) (4 6 8 0 2)
;;  (4 6 8 2 0) (4 8 0 2 6) (4 8 0 6 2) (4 8 2 0 6) (4 8 2 6 0)
;;  (4 8 6 0 2) (4 8 6 2 0) (6 0 2 4 8) (6 0 2 8 4) (6 0 4 2 8)
;;  (6 0 4 8 2) (6 0 8 2 4) (6 0 8 4 2) (6 2 0 4 8) (6 2 0 8 4)
;;  (6 2 4 0 8) (6 2 4 8 0) (6 2 8 0 4) (6 2 8 4 0) (6 4 0 2 8)
;;  (6 4 0 8 2) (6 4 2 0 8) (6 4 2 8 0) (6 4 8 0 2) (6 4 8 2 0)
;;  (6 8 0 2 4) (6 8 0 4 2) (6 8 2 0 4) (6 8 2 4 0) (6 8 4 0 2)
;;  (6 8 4 2 0) (8 0 2 4 6) (8 0 2 6 4) (8 0 4 2 6) (8 0 4 6 2)
;;  (8 0 6 2 4) (8 0 6 4 2) (8 2 0 4 6) (8 2 0 6 4) (8 2 4 0 6)
;;  (8 2 4 6 0) (8 2 6 0 4) (8 2 6 4 0) (8 4 0 2 6) (8 4 0 6 2)
;;  (8 4 2 0 6) (8 4 2 6 0) (8 4 6 0 2) (8 4 6 2 0) (8 6 0 2 4)
;;  (8 6 0 4 2) (8 6 2 0 4) (8 6 2 4 0) (8 6 4 0 2) (8 6 4 2 0))

